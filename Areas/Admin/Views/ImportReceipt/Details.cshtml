@model CuaHangBanSach.Models.ImportReceipt
@using Microsoft.AspNetCore.Mvc.Rendering

@{
    ViewData["Title"] = $"Chi ti·∫øt h√≥a ƒë∆°n nh·∫≠p #{Model.Id}";
    Layout = "~/Areas/Admin/Views/Shared/_Layout.cshtml";
}

<h2 class="text-center my-4 fw-bold">Chi ti·∫øt h√≥a ƒë∆°n nh·∫≠p #@Model.Id</h2>

<div class="card p-3 mb-4">
    <p><strong>Nh√† cung c·∫•p:</strong> @Model.Supplier?.Name</p>
    <p><strong>Ng√†y nh·∫≠p:</strong> @Model.ImportDate.ToString("dd/MM/yyyy HH:mm")</p>
    <p><strong>Ghi ch√∫:</strong> @Model.Notes</p>
    <p>
        <strong>Tr·∫°ng th√°i:</strong>
        @if (Model.Status == "ƒê√£ ho√†n th√†nh" || Model.Status == "ƒê√£ h·ªßy")
        {
            <span class="text-muted">@Model.Status</span>
        }
        else
        {
            <form asp-action="UpdateStatus" method="post" class="d-inline">
                <input type="hidden" name="id" value="@Model.Id" />
                @Html.DropDownList("status", new SelectList(new[]
                {
                    new { Value = "ƒê√£ ƒë·∫∑t", Text = "ƒê√£ ƒë·∫∑t" },
                        new { Value = "ƒê√£ ho√†n th√†nh", Text = "ƒê√£ ho√†n th√†nh" },
                        new { Value = "ƒê√£ h·ªßy", Text = "ƒê√£ h·ªßy" }
                        }, "Value", "Text", Model.Status), new { @class = "form-select form-select-sm d-inline w-auto", onchange = "this.form.submit()" })
        </form>
                }
    </p>
    <p><strong>T·ªïng ti·ªÅn:</strong> @($"{Model.TotalAmount:N0} VND")</p>

    @if (Model.Status == "ƒê√£ ho√†n th√†nh")
    {
        <p class="mt-3">
            <a asp-action="Print" asp-route-id="@Model.Id" target="_blank" class="btn btn-primary">
                üñ®Ô∏è In h√≥a ƒë∆°n
            </a>
        </p>
    }
</div>

<h5 class="mb-3">Danh s√°ch s·∫£n ph·∫©m</h5>
<table class="table table-bordered text-center">
    <thead class="table-light">
        <tr>
            <th>#</th>
            <th>H√¨nh ·∫£nh</th>
            <th>T√™n s·∫£n ph·∫©m</th>
            <th>Bi·∫øn th·ªÉ</th>
            <th>S·ªë l∆∞·ª£ng</th>
            <th>Gi√° nh·∫≠p</th>
            <th>Th√†nh ti·ªÅn</th>
        </tr>
    </thead>
    <tbody>
        @for (int i = 0; i < Model.Details.Count; i++)
        {
            var detail = Model.Details[i];
            var variant = detail.ProductVariant;
            var product = variant?.Product;

            <tr>
                <td>@(i + 1)</td>
                <td>
                    <img src="@variant?.ImageUrl" style="width: 70px; height: auto;" class="img-thumbnail" />
                </td>
                <td>@product?.Name</td>
                <td>@variant?.Color / @variant?.Size</td>
                <td>@detail.Quantity</td>
                <td>@($"{detail.UnitPrice:N0} VND")</td>
                <td>@($"{detail.TotalPrice:N0} VND")</td>
            </tr>
        }
    </tbody>
</table>

<div class="text-center mt-4">
    <a asp-action="Index" class="btn btn-secondary">Quay l·∫°i danh s√°ch</a>
</div>